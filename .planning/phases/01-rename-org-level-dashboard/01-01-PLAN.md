---
phase: 01-rename-org-level-dashboard
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - reportcard-server/src/main/java/io/github/ericdriggs/reportcard/controller/graph/GraphUIController.java
  - reportcard-server/src/main/java/io/github/ericdriggs/reportcard/controller/graph/PipelineDashboardHtmlHelper.java
  - reportcard-server/src/main/java/io/github/ericdriggs/reportcard/controller/browse/BrowseHtmlHelper.java
autonomous: false

must_haves:
  truths:
    - "User can access org-level jobs dashboard at /company/{company}/org/{org}/jobs"
    - "Old /company/{company}/org/{org}/pipelines URLs redirect to /jobs with HTTP 301"
    - "Dashboard page title displays 'Org Jobs' instead of 'Org Pipelines'"
    - "Navigation breadcrumb shows 'Jobs ⏲' link instead of 'Pipelines ⏲'"
    - "Query parameters (?days=90, ?jobInfo=...) are preserved through redirect"
  artifacts:
    - path: "reportcard-server/src/main/java/io/github/ericdriggs/reportcard/controller/graph/GraphUIController.java"
      provides: "New /jobs endpoint and /pipelines redirect"
      contains: "@GetMapping.*company/\\{company\\}/org/\\{org\\}/jobs"
    - path: "reportcard-server/src/main/java/io/github/ericdriggs/reportcard/controller/graph/PipelineDashboardHtmlHelper.java"
      provides: "Updated page title 'Org Jobs'"
      contains: "Org Jobs"
    - path: "reportcard-server/src/main/java/io/github/ericdriggs/reportcard/controller/browse/BrowseHtmlHelper.java"
      provides: "Updated navigation link 'Jobs ⏲'"
      contains: "Jobs ⏲"
  key_links:
    - from: "GraphUIController /pipelines endpoint"
      to: "RedirectView pointing to /jobs"
      via: "HTTP 301 redirect"
      pattern: "RedirectView.*setStatusCode.*MOVED_PERMANENTLY"
    - from: "RedirectView"
      to: "Query parameter preservation"
      via: "HttpServletRequest.getQueryString()"
      pattern: "getQueryString\\(\\)"
---

<objective>
Rename org-level dashboard from "pipelines" to "jobs" terminology in URLs and UI, with backwards-compatible redirect.

Purpose: Align user-facing terminology with actual functionality - these are jobs, not CI/CD pipelines. This phase establishes the foundation for Phase 2 (company-level dashboard).

Output: Working /jobs endpoint with redirect from /pipelines, updated UI text, verified functionality.
</objective>

<execution_context>
@/Users/eric.r.driggs/.claude/get-shit-done/workflows/execute-plan.md
@/Users/eric.r.driggs/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-rename-org-level-dashboard/01-RESEARCH.md
@reportcard-server/src/main/java/io/github/ericdriggs/reportcard/controller/graph/GraphUIController.java
@reportcard-server/src/main/java/io/github/ericdriggs/reportcard/controller/graph/PipelineDashboardHtmlHelper.java
@reportcard-server/src/main/java/io/github/ericdriggs/reportcard/controller/browse/BrowseHtmlHelper.java
</context>

<tasks>

<task type="auto">
  <name>Task 1: Rename URL endpoint and add redirect</name>
  <files>reportcard-server/src/main/java/io/github/ericdriggs/reportcard/controller/graph/GraphUIController.java</files>
  <action>
In GraphUIController.java line 210:

1. Duplicate the existing `@GetMapping(path = "company/{company}/org/{org}/pipelines", ...)` method
2. Change the duplicated method's path to `company/{company}/org/{org}/jobs` - keep all other logic identical
3. Update the original `/pipelines` endpoint to return a RedirectView:
   - Change return type from `ResponseEntity<String>` to `RedirectView`
   - Add `HttpServletRequest request` parameter
   - Implementation:
     ```java
     String redirectUrl = String.format("/company/%s/org/%s/jobs", company, org);
     String queryString = request.getQueryString();
     if (queryString != null && !queryString.isEmpty()) {
         redirectUrl += "?" + queryString;
     }
     RedirectView redirectView = new RedirectView(redirectUrl);
     redirectView.setStatusCode(HttpStatus.MOVED_PERMANENTLY);
     return redirectView;
     ```
4. Add import: `org.springframework.web.servlet.view.RedirectView`
5. Add import: `javax.servlet.http.HttpServletRequest`
6. Add import: `org.springframework.http.HttpStatus`

Why this approach:
- RedirectView (not string "redirect:...") gives explicit control over HTTP 301 vs 302
- HTTP 301 MOVED_PERMANENTLY tells browsers/search engines this is permanent
- Preserving query string ensures ?days=90 and ?jobInfo=... filters work through redirect
- Duplicating method (not renaming) maintains backwards compatibility
  </action>
  <verify>
Build the project: `./gradlew build -x test` (compile check)
Start server: `./gradlew bootRun` in background
Wait for server startup (watch for "Started ReportcardApplication" log)
Test new endpoint: `curl -I http://localhost:8080/company/testco/org/testorg/jobs`
Test redirect: `curl -I http://localhost:8080/company/testco/org/testorg/pipelines`
Verify redirect returns HTTP 301 and Location header points to /jobs
Test with query params: `curl -I "http://localhost:8080/company/testco/org/testorg/pipelines?days=30"`
Verify Location header includes ?days=30
  </verify>
  <done>
- GraphUIController.java has two endpoints: /jobs (main) and /pipelines (redirect)
- /jobs endpoint returns HTML dashboard (status 200)
- /pipelines endpoint returns HTTP 301 redirect to /jobs
- Query parameters are preserved through redirect
- Project builds without compilation errors
  </done>
</task>

<task type="auto">
  <name>Task 2: Update UI terminology</name>
  <files>reportcard-server/src/main/java/io/github/ericdriggs/reportcard/controller/graph/PipelineDashboardHtmlHelper.java, reportcard-server/src/main/java/io/github/ericdriggs/reportcard/controller/browse/BrowseHtmlHelper.java</files>
  <action>
**In PipelineDashboardHtmlHelper.java line 25:**
1. Change `"Org Pipelines"` to `"Org Jobs"`
2. Change `"All Pipelines"` to `"All Jobs"` (in the title variable line 24)

**In BrowseHtmlHelper.java line 130:**
1. Change URL path from `/pipelines?days=90` to `/jobs?days=90`
2. Change link text from `" Pipelines ⏲"` to `" Jobs ⏲"`

Why these specific changes:
- User sees "Org Jobs" as page title (not "Org Pipelines")
- User sees "Jobs ⏲" in breadcrumb navigation (not "Pipelines ⏲")
- Navigation links point to new /jobs URLs
- Internal code (method names, variables) stays as-is per user decision (no unnecessary churn)
  </action>
  <verify>
Build the project: `./gradlew build -x test`
Verify no compilation errors
Grep for remaining "Pipelines" references: `grep -r "Pipelines" reportcard-server/src/main/java/io/github/ericdriggs/reportcard/controller/graph/ reportcard-server/src/main/java/io/github/ericdriggs/reportcard/controller/browse/BrowseHtmlHelper.java`
Confirm only expected occurrences remain (method names, comments, not UI text)
  </verify>
  <done>
- PipelineDashboardHtmlHelper generates page title "Org Jobs - {jobName}"
- BrowseHtmlHelper navigation shows "Jobs ⏲" link pointing to /jobs?days=90
- No user-facing "Pipelines" text remains in these files
- Project builds successfully
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
Renamed org-level dashboard from /pipelines to /jobs with:
- New primary endpoint at /company/{company}/org/{org}/jobs
- HTTP 301 redirect from old /pipelines URLs (preserves bookmarks)
- Updated page title to "Org Jobs"
- Updated navigation links to "Jobs"
  </what-built>
  <how-to-verify>
1. Start the server if not running: `./gradlew bootRun`
2. Wait for "Started ReportcardApplication" in logs
3. Open browser to http://localhost:8080/company/testco/org/testorg/jobs
   - Expected: Dashboard loads, page title shows "Org Jobs"
4. Test old URL: http://localhost:8080/company/testco/org/testorg/pipelines
   - Expected: Browser redirects to /jobs URL (check address bar changes)
5. Test with filters: http://localhost:8080/company/testco/org/testorg/pipelines?days=30
   - Expected: Redirects to /jobs?days=30 (parameters preserved)
6. Check navigation breadcrumbs:
   - Expected: "Jobs ⏲" link (not "Pipelines ⏲")
7. Test with different company/org values if available in your data
8. Verify no visual regressions (layout, styling unchanged)
  </how-to-verify>
  <resume-signal>
Type "approved" to continue, or describe any issues found (missing redirects, broken links, wrong terminology).
  </resume-signal>
</task>

</tasks>

<verification>
1. Build succeeds: `./gradlew build`
2. Server starts: `./gradlew bootRun`
3. New endpoint accessible: GET /company/{company}/org/{org}/jobs returns HTML
4. Old endpoint redirects: GET /company/{company}/org/{org}/pipelines returns HTTP 301
5. Query parameters preserved through redirect
6. Page title displays "Org Jobs - {jobName}"
7. Navigation shows "Jobs ⏲" link
8. Manual testing confirms user experience is correct
</verification>

<success_criteria>
- User can access org-level jobs dashboard at /company/{company}/org/{org}/jobs
- Old /pipelines URLs automatically redirect with HTTP 301
- Dashboard displays "Jobs" terminology throughout UI
- No broken links or missing functionality
- Query parameters work correctly after redirect
- Phase 1 requirements URL-01, URL-02, UI-01, UI-02 are satisfied
</success_criteria>

<output>
After completion, create `.planning/phases/01-rename-org-level-dashboard/01-01-SUMMARY.md` using the summary template.
</output>
