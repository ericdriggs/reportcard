---
phase: 07-tags-investigation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - .planning/phases/07-tags-investigation/07-01-TAG-MAPPING-SPEC.md
autonomous: true

must_haves:
  truths:
    - "Karate JSON tag structure documented with concrete examples"
    - "Mapping from Karate JSON to test_result JSON defined"
    - "@ prefix stripping rule documented with rationale"
    - "Feature vs scenario tag hierarchy clear"
  artifacts:
    - path: ".planning/phases/07-tags-investigation/07-01-TAG-MAPPING-SPEC.md"
      provides: "Model Mapper specification for Karate tags"
      contains: "JSON path extraction patterns"
  key_links: []
---

<objective>
Document Model Mapper patterns for extracting tags from Karate JSON and mapping them into test_result JSON structure.

Purpose: Provide concrete specification for future implementation of tag extraction during Karate JSON parsing (Phase 3 infrastructure).
Output: TAG-MAPPING-SPEC.md with JSON path patterns, data model, and extraction logic pseudocode.
</objective>

<execution_context>
@/Users/eric.r.driggs/.claude/get-shit-done/workflows/execute-plan.md
@/Users/eric.r.driggs/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/07-tags-investigation/07-CONTEXT.md
@.planning/phases/07-tags-investigation/07-RESEARCH.md

# Karate JSON structure reference
@cucumber-json/karate-reports/delorean-create-dss-test.json
</context>

<tasks>

<task type="auto">
  <name>Task 1: Document Karate JSON tag structure</name>
  <files>.planning/phases/07-tags-investigation/07-01-TAG-MAPPING-SPEC.md</files>
  <action>
Create 07-01-TAG-MAPPING-SPEC.md documenting the Karate JSON tag structure:

1. **Source Analysis** - Read sample Karate JSON files to understand tag structure:
   - Feature-level tags (in feature results)
   - Scenario-level tags (in scenarioResults[].tags)
   - Tag object format: `{"name": "@tagname", "line": N}`

2. **Document JSON Paths** - Specify exact JSON paths for extraction:
   - Feature tags: `$.featureResults[*].tags` (or similar)
   - Scenario tags: `$.featureResults[*].scenarioResults[*].tags`
   - Note: Nested call results have tags but are excluded per CONTEXT.md

3. **Document Tag Transformation**:
   - Strip `@` prefix from stored tags (per CONTEXT.md)
   - Key-value format: `env=staging` stored as-is after @ removal
   - Simple tags: `smoke` stored as-is after @ removal

4. **Mapping to test_result Structure**:
   - Feature tags → test_suite.tags in test_suites_json
   - Scenario tags → test_case.tags in test_suites_json
   - Preserve hierarchy: test_suite contains test_cases with their respective tags

5. **Extraction Pseudocode**:
   - Jackson JsonNode traversal pattern
   - Tag extraction helper method
   - Integration point with existing KarateConvertersUtil

Include concrete JSON examples from actual Karate reports.
  </action>
  <verify>
File exists: .planning/phases/07-tags-investigation/07-01-TAG-MAPPING-SPEC.md
File contains JSON path patterns (e.g., `$.featureResults`)
File contains transformation rules (@ prefix stripping)
File contains mapping hierarchy (feature → test_suite, scenario → test_case)
  </verify>
  <done>
TAG-MAPPING-SPEC.md documents complete extraction pipeline from Karate JSON to test_result structure with concrete examples and pseudocode.
  </done>
</task>

</tasks>

<verification>
- [ ] TAG-MAPPING-SPEC.md exists in phase directory
- [ ] Document includes actual Karate JSON examples (not hypothetical)
- [ ] JSON path patterns are syntactically valid
- [ ] Transformation rules match CONTEXT.md decisions (@ stripping, top-level only)
- [ ] Mapping to test_suites_json structure is clear
</verification>

<success_criteria>
Phase success criterion #1 addressed: "Model Mapper patterns documented for Karate JSON → test_result JSON mapping"
</success_criteria>

<output>
After completion, create `.planning/phases/07-tags-investigation/07-01-SUMMARY.md`
</output>
