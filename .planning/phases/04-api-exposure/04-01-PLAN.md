---
phase: 04-api-exposure
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - reportcard-server/src/main/java/io/github/ericdriggs/reportcard/controller/browse/BrowseJsonController.java
autonomous: true

must_haves:
  truths:
    - "User can view BrowseJsonController endpoints in Swagger UI at /swagger-ui.html"
    - "User can access /v1/api/* endpoints via HTTP without @Hidden restriction"
    - "User can observe no path conflicts between HTML and JSON controllers"
    - "All existing tests continue to pass after annotation removal"
  artifacts:
    - path: "reportcard-server/src/main/java/io/github/ericdriggs/reportcard/controller/browse/BrowseJsonController.java"
      provides: "Exposed JSON API controller"
      contains: "@RestController"
      not_contains: "@Hidden"
  key_links:
    - from: "BrowseJsonController"
      to: "/swagger-ui.html"
      via: "springdoc-openapi annotation scanning"
      pattern: "@RestController.*@RequestMapping"
---

<objective>
Remove @Hidden annotation from BrowseJsonController to expose JSON API endpoints publicly.

Purpose: Final step in browse-json feature implementation. Makes /v1/api/* endpoints discoverable in Swagger UI and accessible to production clients (CI/CD pipelines).

Output: Exposed JSON API with all 12+ browse endpoints visible in OpenAPI documentation.
</objective>

<execution_context>
@/Users/eric.r.driggs/.claude/get-shit-done/workflows/execute-plan.md
@/Users/eric.r.driggs/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-api-exposure/04-RESEARCH.md
@reportcard-server/src/main/java/io/github/ericdriggs/reportcard/controller/browse/BrowseJsonController.java
@reportcard-server/src/main/java/io/github/ericdriggs/reportcard/controller/graph/GraphJsonController.java
</context>

<tasks>

<task type="auto">
  <name>Task 1: Remove @Hidden annotation and verify API exposure</name>
  <files>reportcard-server/src/main/java/io/github/ericdriggs/reportcard/controller/browse/BrowseJsonController.java</files>
  <action>
    Remove the @Hidden annotation from BrowseJsonController.java line 25.

    BEFORE (current state):
    ```java
    @RestController
    @RequestMapping("/v1/api")
    @Hidden
    @SuppressWarnings("unused")
    public class BrowseJsonController {
    ```

    AFTER (target state):
    ```java
    @RestController
    @RequestMapping("/v1/api")
    @SuppressWarnings("unused")
    public class BrowseJsonController {
    ```

    Also remove the now-unused import statement:
    ```java
    import io.swagger.v3.oas.annotations.Hidden;
    ```

    DO NOT:
    - Add @Operation annotations (out of scope for this phase)
    - Modify any endpoint implementations
    - Change any other annotations
  </action>
  <verify>
    1. Run tests to verify no regressions:
       ```bash
       ./gradlew test --tests "io.github.ericdriggs.reportcard.controller.browse.BrowseJsonControllerTest"
       ```
    2. Verify file no longer contains @Hidden:
       ```bash
       grep -c "@Hidden" reportcard-server/src/main/java/io/github/ericdriggs/reportcard/controller/browse/BrowseJsonController.java
       # Should return 0
       ```
    3. Run full test suite to confirm no path conflicts:
       ```bash
       ./gradlew test
       ```
  </verify>
  <done>
    - @Hidden annotation removed from BrowseJsonController
    - Unused Hidden import removed
    - All 30+ BrowseJsonController tests pass
    - Full test suite passes (no AmbiguousMappingException)
    - File contains @RestController and @RequestMapping("/v1/api") but not @Hidden
  </done>
</task>

<task type="auto">
  <name>Task 2: Validate OpenAPI documentation exposure</name>
  <files>None (verification only)</files>
  <action>
    Verify that BrowseJsonController endpoints appear in OpenAPI specification.

    1. Start the application in test mode or use existing integration test infrastructure
    2. Verify OpenAPI spec generation includes browse endpoints

    Since Swagger UI requires a running application, validate using:
    - Test class context loading (verifies no startup conflicts)
    - Grep for endpoints in OpenAPI annotations to confirm visibility

    Alternative verification if application startup test exists:
    ```bash
    ./gradlew test --tests "*ApplicationContextTest*" || ./gradlew test --tests "*ApplicationTests*"
    ```

    If no dedicated startup test exists, the full test suite already validates application context loading.
  </action>
  <verify>
    1. Confirm application context loads successfully:
       ```bash
       ./gradlew test 2>&1 | grep -i "context\|startup\|failed" | head -20
       ```
    2. Verify GraphJsonController is already exposed (reference):
       ```bash
       grep -c "@Hidden" reportcard-server/src/main/java/io/github/ericdriggs/reportcard/controller/graph/GraphJsonController.java
       # Should return 0 (GraphJsonController is NOT hidden)
       ```
    3. Verify BrowseJsonController now matches GraphJsonController pattern (no @Hidden):
       ```bash
       diff <(grep -E "@(RestController|RequestMapping|Hidden)" reportcard-server/src/main/java/io/github/ericdriggs/reportcard/controller/browse/BrowseJsonController.java) \
            <(grep -E "@(RestController|RequestMapping|Hidden)" reportcard-server/src/main/java/io/github/ericdriggs/reportcard/controller/graph/GraphJsonController.java)
       ```
  </verify>
  <done>
    - Application context loads without AmbiguousMappingException
    - BrowseJsonController follows same exposure pattern as GraphJsonController
    - No @Hidden annotation present on either JSON controller
    - All tests pass confirming no path conflicts
  </done>
</task>

</tasks>

<verification>
Phase 4 is complete when:
1. BrowseJsonController.java contains @RestController and @RequestMapping("/v1/api") but NOT @Hidden
2. All existing tests pass (no regressions)
3. Application context loads successfully (no path conflicts)
4. Browse JSON endpoints are exposed following same pattern as GraphJsonController
</verification>

<success_criteria>
- API-01 requirement satisfied: @Hidden annotation removed from BrowseJsonController
- Zero test failures
- Zero path conflict errors (AmbiguousMappingException)
- BrowseJsonController endpoints now discoverable via OpenAPI/Swagger
</success_criteria>

<output>
After completion, create `.planning/phases/04-api-exposure/04-01-SUMMARY.md`
</output>
